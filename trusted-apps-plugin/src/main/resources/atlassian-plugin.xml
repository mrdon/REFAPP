<atlassian-plugin key="${atlassian.plugin.key}" name="${pom.name}" pluginsVersion="2">
    <plugin-info>
        <description>${pom.description}</description>
        <version>${pom.version}</version>
        <vendor name="${pom.organization.name}" url="${pom.organization.url}" />
        <bundle-instructions>
            <Export-Package>com.atlassian.security.auth.trustedapps</Export-Package>
            <Import-Package>
                com.atlassian.user,com.atlassian.seraph.auth,com.atlassian.seraph.config,
                org.bouncycastle.jce.provider,org.bouncycastle.util.encoders,javax.crypto,
                org.apache.velocity.context,
                javax.servlet.http,javax.servlet,
                org.slf4j
            </Import-Package>
        </bundle-instructions>
    </plugin-info>
    
    <component-import key="user-manager" interface="com.atlassian.user.UserManager" />
    
    <component key="encryption-provider" class="com.atlassian.security.auth.trustedapps.BouncyCastleEncryptionProvider" />
    <component key="trusted-apps-manager" class="com.atlassian.refapp.trustedapps.internal.RefAppTrustedApplicationsManagerImpl" public="true">
        <interface>com.atlassian.refapp.trustedapps.RefAppTrustedApplicationsManager</interface>
        <interface>com.atlassian.security.auth.trustedapps.TrustedApplicationsManager</interface>
    </component>
    <component key="user-resolver" class="com.atlassian.refapp.trustedapps.internal.RefAppUserResolverImpl" />
    
    <servlet-filter key="seraph-trusted-apps-filter" class="com.atlassian.security.auth.trustedapps.seraph.filter.SeraphTrustedApplicationsFilter" location="before-login" weight="1000000">
        <url-pattern>/*</url-pattern>
    </servlet-filter>
    
    <servlet key="trusted-apps-management-servlet" class="com.atlassian.refapp.trustedapps.internal.TrustedAppsManagementServlet">
        <url-pattern>/trusted-apps</url-pattern>
    </servlet>
</atlassian-plugin>
